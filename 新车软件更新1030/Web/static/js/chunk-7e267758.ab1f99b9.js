(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e267758"],{"2e08":function(t,e,a){var i=a("9def"),n=a("9744"),r=a("be13");t.exports=function(t,e,a,o){var l=String(r(t)),s=l.length,c=void 0===a?" ":String(a),u=i(e);if(u<=s||""==c)return l;var d=u-s,h=n.call(c,Math.ceil(d/c.length));return h.length>d&&(h=h.slice(0,d)),o?h+l:l+h}},3480:function(t,e,a){"use strict";a.d(e,"d",function(){return n}),a.d(e,"e",function(){return r}),a.d(e,"a",function(){return o}),a.d(e,"b",function(){return l}),a.d(e,"f",function(){return s}),a.d(e,"j",function(){return c}),a.d(e,"i",function(){return u}),a.d(e,"g",function(){return d}),a.d(e,"h",function(){return h});var i=a("b775");function n(t){return Object(i["a"])({url:"api/OutTask/GetPageRecords",method:"get",params:t})}function r(t){return Object(i["a"])({url:"api/OutTask/GetOutTaskMaterialList",method:"get",params:{OutTaskCode:t}})}function o(t){return Object(i["a"])({url:"api/OutTask/PostDoCreate",method:"post",data:t})}function l(t){return Object(i["a"])({url:"api/OutTask/PostDoDelete",method:"post",data:t})}function s(t){return Object(i["a"])({url:"api/OutTask/PostDoSendOrder",method:"post",data:t})}function c(t){return Object(i["a"])({url:"api/OutTask/ConfirmHandPicked",method:"post",data:t})}function u(t){return Object(i["a"])({url:"api/OutTask/PostTaskMaterialLabelList",method:"post",data:t})}function d(t){return Object(i["a"])({url:"api/OutTask/PostDoStartContrainer",method:"post",data:t})}function h(t){return Object(i["a"])({url:"api/OutTask/PostRestoreContrainer",method:"post",data:t})}},"5c83":function(t,e,a){"use strict";a("a481"),a("6762"),a("2fdb");var i={bind:function(t,e,a){var i=t.querySelector(".el-dialog__header"),n=t.querySelector(".el-dialog");i.style.cssText+=";cursor:move;",n.style.cssText+=";top:0px;";var r=function(){return window.document.currentStyle?function(t,e){return t.currentStyle[e]}:function(t,e){return getComputedStyle(t,!1)[e]}}();i.onmousedown=function(t){var e=t.clientX-i.offsetLeft,o=t.clientY-i.offsetTop,l=n.offsetWidth,s=n.offsetHeight,c=document.body.clientWidth,u=document.body.clientHeight,d=n.offsetLeft,h=c-n.offsetLeft-l,p=n.offsetTop,f=u-n.offsetTop-s,g=r(n,"left"),m=r(n,"top");g.includes("%")?(g=+document.body.clientWidth*(+g.replace(/\%/g,"")/100),m=+document.body.clientHeight*(+m.replace(/\%/g,"")/100)):(g=+g.replace(/\px/g,""),m=+m.replace(/\px/g,"")),document.onmousemove=function(t){var i=t.clientX-e,r=t.clientY-o;-i>d?i=-d:i>h&&(i=h),-r>p?r=-p:r>f&&(r=f),n.style.cssText+=";left:".concat(i+g,"px;top:").concat(r+m,"px;"),a.child.$emit("dragDialog")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}},n=function(t){t.directive("el-drag-dialog",i)};window.Vue&&(window["el-drag-dialog"]=i,Vue.use(n)),i.install=n;e["a"]=i},6724:function(t,e,a){"use strict";a("8d41");var i="@@wavesContext";function n(t,e){function a(a){var i=Object.assign({},e.value),n=Object.assign({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},i),r=n.ele;if(r){r.style.position="relative",r.style.overflow="hidden";var o=r.getBoundingClientRect(),l=r.querySelector(".waves-ripple");switch(l?l.className="waves-ripple":(l=document.createElement("span"),l.className="waves-ripple",l.style.height=l.style.width=Math.max(o.width,o.height)+"px",r.appendChild(l)),n.type){case"center":l.style.top=o.height/2-l.offsetHeight/2+"px",l.style.left=o.width/2-l.offsetWidth/2+"px";break;default:l.style.top=(a.pageY-o.top-l.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",l.style.left=(a.pageX-o.left-l.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return l.style.backgroundColor=n.color,l.className="waves-ripple z-active",!1}}return t[i]?t[i].removeHandle=a:t[i]={removeHandle:a},a}var r={bind:function(t,e){t.addEventListener("click",n(t,e),!1)},update:function(t,e){t.removeEventListener("click",t[i].removeHandle,!1),t.addEventListener("click",n(t,e),!1)},unbind:function(t){t.removeEventListener("click",t[i].removeHandle,!1),t[i]=null,delete t[i]}},o=function(t){t.directive("waves",r)};window.Vue&&(window.waves=r,Vue.use(o)),r.install=o;e["a"]=r},"8d41":function(t,e,a){},9744:function(t,e,a){"use strict";var i=a("4588"),n=a("be13");t.exports=function(t){var e=String(n(this)),a="",r=i(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(a+=e);return a}},d43b:function(t,e,a){"use strict";a.d(e,"m",function(){return n}),a.d(e,"n",function(){return r}),a.d(e,"p",function(){return o}),a.d(e,"j",function(){return l}),a.d(e,"d",function(){return s}),a.d(e,"e",function(){return c}),a.d(e,"a",function(){return u}),a.d(e,"o",function(){return d}),a.d(e,"f",function(){return h}),a.d(e,"g",function(){return p}),a.d(e,"l",function(){return f}),a.d(e,"k",function(){return g}),a.d(e,"h",function(){return m}),a.d(e,"i",function(){return v}),a.d(e,"b",function(){return b}),a.d(e,"c",function(){return k});var i=a("b775");function n(t){return Object(i["a"])({url:"api/Stock/GetPageRecords",method:"get",params:t})}function r(t){return Object(i["a"])({url:"api/Stock/GetStockLabel",method:"get",params:{code:t}})}function o(t){return Object(i["a"])({url:"api/Stock/DoUpLoadInInfo",method:"post",data:t})}function l(t){return Object(i["a"])({url:"api/Stock/GetMaterialPageRecords",method:"get",params:t})}function s(t){return Object(i["a"])({url:"api/Stock/LightStock",method:"post",data:t})}function c(){return Object(i["a"])({url:"api/Stock/OffLightStock",method:"post"})}function u(t){return Object(i["a"])({url:"api/Stock/DeleteStockArray",method:"post",data:t})}function d(){return Object(i["a"])({url:"api/MobileLocation/GetWareHouseList",method:"get"})}function h(t){return Object(i["a"])({url:"api/Dictionary/GetDictionaryByType",method:"get",params:{type:t}})}function p(t){return Object(i["a"])({url:"api/Stock/GetInactiveStockPageRecords",method:"get",params:t})}function f(t){return Object(i["a"])({url:"api/Stock/GetMaterialStatusPageRecords",method:"get",params:t})}function g(t){return Object(i["a"])({url:"api/Stock/GetMaterialStatusList",method:"get",params:{MaterialCode:t}})}function m(t){return Object(i["a"])({url:"api/Stock/GetInventoryStatusPageRecords",method:"get",params:t})}function v(t){return Object(i["a"])({url:"api/Stock/GetLocationStockByLayoutId",method:"get",params:{layoutId:t}})}function b(t){return Object(i["a"])({url:"api/Stock/DoDownLoadLabelStock",method:"get",params:t,responseType:"blob"})}function k(t){return Object(i["a"])({url:"api/Stock/DoDownLoadMaterialStock",method:"get",params:t,responseType:"blob"})}},f576:function(t,e,a){"use strict";var i=a("5ca1"),n=a("2e08"),r=a("a25f"),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);i(i.P+i.F*o,"String",{padStart:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},fe0d:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"search-card"},[a("div",{staticClass:"filter-container",staticStyle:{"margin-bottom":"10px"}},[a("el-input",{staticClass:"filter-item",attrs:{placeholder:"出库单号",clearable:""},on:{clear:t.handleFilter},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.Code,callback:function(e){t.$set(t.listQuery,"Code",e)},expression:"listQuery.Code"}}),t._v(" "),a("el-select",{attrs:{multiple:!1,filterable:"",remote:"","reserve-keyword":""},on:{change:t.handleFilter},model:{value:t.listQuery.Status,callback:function(e){t.$set(t.listQuery,"Status",e)},expression:"listQuery.Status"}},t._l(t.statusList,function(t){return a("el-option",{key:t.Code,attrs:{label:t.Name,value:t.Code}})}),1),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"filter-button",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加")]),t._v(" "),a("el-button",{staticClass:"filter-button",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleInterfaceCreate}},[t._v("同步")]),t._v(" "),a("el-upload",{ref:"fileupload",staticStyle:{display:"inline","margin-left":"10px","margin-right":"10px"},attrs:{action:"#","show-file-list":!1,"http-request":t.uploadFile,"before-upload":t.beforeUpload,"on-exceed":t.handleExceed}},[a("el-button",{attrs:{type:"primary"}},[a("i",{staticClass:"el-icon-upload el-icon--right"}),t._v("  导入")])],1),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-button",attrs:{loading:t.downloadLoading,type:"primary",icon:"el-icon-download"},on:{click:t.handleDownUpload}},[t._v(t._s("模板"))])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.TableKey,staticStyle:{width:"100%","min-height":"100%"},attrs:{data:t.list,"header-cell-style":{background:"#F5F7FA"},height:"331",size:"mini",border:"",fit:"","highlight-current-row":""},on:{"row-click":t.handleRowClick}},[a("el-table-column",{attrs:{type:"index"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.Status?a("el-tag",{attrs:{type:"warning"}},[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e(),t._v(" "),1===e.row.Status?a("el-tag",{attrs:{type:"warning"}},[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e(),t._v(" "),2===e.row.Status?a("el-tag",[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e(),t._v(" "),3===e.row.Status?a("el-tag",{attrs:{type:"success"}},[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e(),t._v(" "),4===e.row.Status?a("el-tag",{attrs:{type:"info"}},[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"出库单号",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.Code))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"出库类型",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.OutDictDescription))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"仓库",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.WareHouseName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作人",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.CreatedUserName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"添加时间",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.CreatedTime))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"来源单据号",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.BillCode))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"备注",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.Remark))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"250","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",icon:"el-icon-delete",circle:""},on:{click:function(a){return t.handleDelete(e.row)}}}),t._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.handleCreateTask(e.row)}}},[t._v("下发")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleCancel(e.row)}}},[t._v("作废")])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":t.listQuery.Page,"page-sizes":[6,12,18,24],"page-size":t.listQuery.Rows,total:t.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],key:t.TableKey,staticStyle:{width:"100%","min-height":"100%"},attrs:{data:t.listMaterial,"header-cell-style":{background:"#F5F7FA"},height:300,size:"mini",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.Status?a("el-tag",{attrs:{type:"warning"}},[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e(),t._v(" "),1===e.row.Status?a("el-tag",{attrs:{type:"warning"}},[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e(),t._v(" "),2===e.row.Status?a("el-tag",[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e(),t._v(" "),3===e.row.Status?a("el-tag",{attrs:{type:"success"}},[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e(),t._v(" "),4===e.row.Status?a("el-tag",{attrs:{type:"info"}},[a("span",[t._v(t._s(e.row.StatusCaption))])]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"出库单号",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.OutCode))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"物料编码",width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.MaterialCode))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"物料描述",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.MaterialName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"重量(g)",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.Quantity))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"已下发重量(g)",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.SendInQuantity))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"已拣选重量(g)",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.PickedQuantity))])]}}])})],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,width:"85%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticClass:"dialog-form",attrs:{rules:t.rules,model:t.Out,"label-width":"100px","label-position":"left"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"仓库编码",prop:"WareHouseCode"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{multiple:!1,filterable:""},on:{change:t.changeWarehouse},model:{value:t.Out.WareHouseCode,callback:function(e){t.$set(t.Out,"WareHouseCode",e)},expression:"Out.WareHouseCode"}},t._l(t.WareHouseList,function(t){return a("el-option",{key:t.Code,attrs:{label:t.Name,value:t.Code}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"出库类型",prop:"LocationCode"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{multiple:!1,"reserve-keyword":""},model:{value:t.Out.OutDict,callback:function(e){t.$set(t.Out,"OutDict",e)},expression:"Out.OutDict"}},t._l(t.dictionaryList,function(t){return a("el-option",{key:t.Code,attrs:{label:t.Name,value:t.Code}})}),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"来源单号",prop:"Name"}},[a("el-input",{staticClass:"dialog-input",attrs:{clearable:"",placeholder:"请输入来源单据号"},model:{value:t.Out.BillCode,callback:function(e){t.$set(t.Out,"BillCode",e)},expression:"Out.BillCode"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注信息"}},[a("el-input",{staticClass:"dialog-input",attrs:{autosize:{minRows:1,maxRows:1},type:"textarea",placeholder:"出库备注"},model:{value:t.Out.Remark,callback:function(e){t.$set(t.Out,"Remark",e)},expression:"Out.Remark"}})],1)],1)],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"20px"}},[a("el-button",{staticClass:"filter-button",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreateOutMaterial}},[t._v("添加")]),t._v(" "),a("el-button",{staticClass:"filter-button",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete"},on:{click:t.handleDeleteOutMaterial}},[t._v("移除")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],key:t.TableKey,ref:"addMaterialGrid",staticStyle:{width:"100%","min-height":"100%"},attrs:{data:t.addMaterial,"header-cell-style":{background:"#F5F7FA"},border:"",fit:"","highlight-current-row":"",height:"350"},on:{"row-click":t.addMaterialGridClick}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"行项目号",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.ItemNo))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"物料名称",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.Status?a("el-select",{staticStyle:{width:"400px"},attrs:{multiple:!1,filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词(物料编码或名称)","remote-method":t.remoteMethod,loading:t.loading},on:{change:function(a){return t.materialCodeChange(e.row)}},model:{value:e.row.MaterialCode,callback:function(a){t.$set(e.row,"MaterialCode",a)},expression:"scope.row.MaterialCode"}},t._l(t.materialList,function(t){return a("el-option",{key:t.Code,attrs:{label:t.Name,value:t.Code}})}),1):a("span",[t._v(t._s(e.row.MaterialName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"物料编码",width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.MaterialCode))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"物料类别",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.MaterialTypeDescription))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"可用库存",width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.AvailableStock))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"重量(g)",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.Status?a("el-input",{attrs:{clearable:""},model:{value:e.row.Quantity,callback:function(a){t.$set(e.row,"Quantity",a)},expression:"scope.row.Quantity"}}):a("span",[t._v(t._s(e.row.Quantity))])]}}])})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确认")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确认")])],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"手动拣选"+t.Out.Code,visible:t.dialogFormLabel,width:"85%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormLabel=e}}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],key:t.TableKey,staticStyle:{"min-height":"100%"},attrs:{data:t.outMaterialCombineList,"header-cell-style":{background:"#F5F7FA"},border:"",fit:"",size:"mini","highlight-current-row":"",height:"450"},on:{"row-click":t.handleMaterialRowClick}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"物料描述",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.MaterialName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"重量(g)",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.Quantity))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"已拣",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.PickedQuantity))])]}}])})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:16}},[a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],key:t.TableKey,staticStyle:{width:"100%","min-height":"100%"},attrs:{data:t.StockList,"header-cell-style":{background:"#F5F7FA"},border:"",fit:"",height:400,size:"mini","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-checkbox",{ref:e.row.Id,attrs:{disabled:e.row.IsCheckLocked},on:{change:function(a){return t.doStockCheck(e.row)}},model:{value:e.row.Checked,callback:function(a){t.$set(e.row,"Checked",a)},expression:"scope.row.Checked"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"物料条码",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.MaterialLabel))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"重量(g)",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.Quantity))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"拣选重量(g)",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.Checked?a("el-input",{staticClass:"edit-input",staticStyle:{width:"80px"},attrs:{size:"mini"},model:{value:e.row.PickedQuantity,callback:function(a){t.$set(e.row,"PickedQuantity",a)},expression:"scope.row.PickedQuantity"}}):a("span",[t._v(t._s(e.row.PickedQuantity))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"锁定重量(g)",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.LockedQuantity))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"盘点锁定",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-color":"#ff4949","inactive-color":"#13ce66",disabled:!0},model:{value:e.row.IsCheckLocked,callback:function(a){t.$set(e.row,"IsCheckLocked",a)},expression:"scope.row.IsCheckLocked"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"单位",width:"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.MaterialUnit))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"仓库名称",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.WareHouseName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"库位地址",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.LocationCode))])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":t.listStockQuery.Page,"page-sizes":[10,20,30,50],"page-size":t.listStockQuery.Rows,total:t.stockTotal,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleStockSizeChange,"current-change":t.handleStockCurrentChange}})],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormLabel=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmPicked}},[t._v("确认")])],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"复核"+t.Out.Code,visible:t.dialogFormCheck,width:"85%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormCheck=e}}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"search-card"},[a("div",{staticClass:"filter-container"},[a("el-input",{ref:"materialLabel",staticClass:"filter-item",attrs:{placeholder:"物料条码",autofocus:!0},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.GetWaitingCheckingLabel(e)}},model:{value:t.searchMaterialLabel,callback:function(e){t.searchMaterialLabel=e},expression:"searchMaterialLabel"}}),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.GetWaitingCheckingLabel}},[t._v("查询")])],1)]),t._v(" "),a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],key:t.TableKey,staticStyle:{width:"100%","min-height":"100%"},attrs:{data:t.WaitingForCheckLabelList,"header-cell-style":{background:"#F5F7FA"},border:"",size:"mini",fit:"","highlight-current-row":"",height:"400"}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"物料条码",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.MaterialName,placement:"top"}},[a("span",[t._v(t._s(e.row.MaterialLabel))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"应拣重量(g)",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.MaterialCode,placement:"top"}},[a("span",[t._v(t._s(e.row.Quantity))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"拣选重量(g)",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.RealPickedQuantity))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"批次",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.BatchCode))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"80","class-name":"small-padding fixed-width",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return t.handConfirmCheck(e.row)}}},[t._v("确认")])]}}])})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],key:t.TableKey,staticStyle:{width:"100%","min-height":"100%"},attrs:{data:t.CheckedLabelList,"header-cell-style":{background:"#F5F7FA"},border:"",fit:"",size:"mini","highlight-current-row":"",height:"500"}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"物料名称",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.MaterialCode,placement:"top"}},[a("span",[t._v(t._s(e.row.MaterialName))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"物料条码",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.MaterialLabel))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"应拣重量(g)",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.Quantity))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"拣选重量(g)",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.RealPickedQuantity))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"库位地址",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.LocationCode))])]}}])})],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormCheck=!1}}},[t._v("取消")])],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"料仓退料",visible:t.dialogOutMaterialVisible,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogOutMaterialVisible=e}}},[a("el-form",{ref:"dataForm",staticClass:"dialog-form",attrs:{rules:t.rules,model:t.Out,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"条码"}},[a("span",[a("el-input",{staticClass:"dialog-input",model:{value:t.Label.Code,callback:function(e){t.$set(t.Label,"Code",e)},expression:"Label.Code"}})],1),t._v(" "),a("span",[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleCheckLabel}})],1)]),t._v(" "),a("div",{staticStyle:{"font-size":"14px"}},[a("div",{staticStyle:{margin:"20px"}},[a("span",[t._v("\n            条码重量(g):\n          ")]),t._v(" "),a("span",[t._v(t._s(t.Label.Quantity))])]),t._v(" "),a("div",{staticStyle:{margin:"20px"}},[a("span",[t._v("\n            当前库位:\n          ")]),t._v(" "),a("span",[t._v(t._s(t.Label.LocationCode))])]),t._v(" "),a("div",{staticStyle:{margin:"20px"}},[a("span",[t._v("\n            物料编码:\n          ")]),t._v(" "),a("span",[t._v(t._s(t.Label.MaterialCode))])]),t._v(" "),a("div",{staticStyle:{margin:"20px"}},[a("span",[t._v("\n            物料名称:\n          ")]),t._v(" "),a("span",[t._v(t._s(t.Label.MaterialName))])]),t._v(" "),a("div",{staticStyle:{margin:"10px"}},[a("span",[t._v("\n            供应商编码:\n          ")]),t._v(" "),a("span",[t._v(t._s(t.Label.SupplyCode))])]),t._v(" "),a("div",{staticStyle:{margin:"20px"}},[a("span",[t._v("\n            供应商名称:\n          ")]),t._v(" "),a("span",[t._v(t._s(t.Label.SupplyName))])]),t._v(" "),a("div",{staticStyle:{margin:"20px"}},[a("span",[t._v("\n            批次:\n          ")]),t._v(" "),a("span",[t._v(t._s(t.Label.Batchcode))])]),t._v(" "),a("div",{staticStyle:{margin:"20px"}},[a("span",[t._v("\n            生产日期:\n          ")]),t._v(" "),a("span",[t._v(t._s(t.Label.ProductionDateFormat))])])])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleAddLabel()}}},[t._v("退料")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.createLabelData()}}},[t._v("完成")])],1)],1)],1)},n=[],r=(a("7514"),a("f576"),a("6b54"),a("ac6a"),a("b775"));function o(t){return Object(r["a"])({url:"api/Out/GetPageRecords",method:"get",params:t})}function l(t){return Object(r["a"])({url:"api/Out/GetOutMaterialList",method:"get",params:{OutCode:t}})}function s(t){return Object(r["a"])({url:"api/Out/GetMaterialList",method:"get",params:{KeyValue:t}})}function c(t){return Object(r["a"])({url:"api/Out/PostDoCreate",method:"post",data:t})}function u(){return Object(r["a"])({url:"api/Out/GetWareHouseList",method:"get"})}function d(t){return Object(r["a"])({url:"api/Out/PostDoDelete",method:"post",data:t})}function h(t){return Object(r["a"])({url:"api/Out/PostDoUpdate",method:"post",data:t})}function p(t){return Object(r["a"])({url:"api/Out/GetEditMaterialList",method:"get",params:{outCode:t}})}function f(t){return Object(r["a"])({url:"api/Dictionary/GetDictionaryByType",method:"get",params:{type:t}})}function g(t,e){return Object(r["a"])({url:"api/Out/GetAvailableStock",method:"get",params:{MaterialCode:t,WareHouseCode:e}})}function m(t){return Object(r["a"])({url:"api/Out/PostDoSendOrder",method:"post",data:t})}function v(t){return Object(r["a"])({url:"api/Out/PostDoGenerateOutLabel",method:"post",data:t})}function b(t){return Object(r["a"])({url:"api/Out/GetCombineOutMaterialList",method:"get",params:{OutCode:t}})}function k(t){return Object(r["a"])({url:"api/Stock/GetPageRecords",method:"get",params:t})}function y(t){return Object(r["a"])({url:"api/Out/ConfirmHandPicked",method:"post",data:t})}function C(t,e,a){return Object(r["a"])({url:"api/Out/GetWaiitingForCheckOrCheckedLabel",method:"get",params:{OutCode:t,Status:e,MaterialLabel:a}})}function _(t){return Object(r["a"])({url:"api/Out/ConfirmCheckLabel",method:"post",data:t})}function w(t){return Object(r["a"])({url:"api/Out/DoUpLoadOutInfo",method:"post",data:t})}function S(t){return Object(r["a"])({url:"api/Out/PostDoCancel",method:"post",data:t})}function O(t){return Object(r["a"])({url:"api/Out/GetInterfaceOut",method:"get"})}var L=a("6724"),M=a("5c83"),x=a("d43b"),N=a("3480"),P={name:"PickOrder",directives:{elDragDialog:M["a"],waves:L["a"]},data:function(){return{total:null,listLoading:!1,fullscreenLoading:!1,listQuery:{Page:1,Rows:6,Code:"",Status:void 0,Sort:"id"},listStockQuery:{Page:1,Rows:10,MaterialCode:"",Status:void 0,Sort:"id",MaterialName:"",BatchCode:"",WareHouseCode:""},dictionaryList:[],downloadLoading:!1,TableKey:0,list:null,listMaterial:null,addMaterial:[],dialogFormVisible:!1,dialogFormLabel:!1,dialogStatus:"",materialList:[],editMaterialList:[],loading:!1,addMaterialGridCurrentRowIndex:void 0,textMap:{update:"编辑出库单",create:"创建出库单"},count:0,Out:{Code:"",BillCode:"",WareHouseCode:"",InDict:void 0,Remark:"",AddMaterial:[],Status:void 0,PickedStockList:[]},OutMaterial:{MaterialCode:"",MaterialName:"",BatchCode:"",Quantity:0,Id:0,ItemNo:""},rules:{Code:[{required:!0,message:"请输入出库单号",trigger:"blur"}],WareHouseCode:[{required:!0,message:"请选择仓库",trigger:"blur"}]},WareHouseList:[],outMaterialLabelList:[],outMaterialCombineList:[],StockList:null,LabelArray:[],stockTotal:0,checkedStockArray:[],currentPickMaterial:void 0,dialogFormCheck:!1,WaitingForCheckLabelList:[],CheckedLabelList:[],searchMaterialLabel:"",dialogOutMaterialVisible:!1,Label:{Code:null,SupplyCode:null,MaterialCode:null,ProductionDate:null,Batchcode:null},addMaterialLabel:[],statusList:[{Code:void 0,Name:"全部"},{Code:0,Name:"待下发"},{Code:1,Name:"部分下发"},{Code:2,Name:"全部下发"},{Code:3,Name:"已完成"},{Code:4,Name:"已作废"}]}},watch:{dialogTreeVisible:function(t){t||this.getList()}},created:function(){this.getList(),this.GetWareHouseList(),this.getOutDictTypeList()},destroyed:function(){this.timer&&clearInterval(this.timer)},methods:{timer:function(){var t=this;return setInterval(function(){t.getList()},1e4)},getOutDictTypeList:function(){var t=this;f("OutType").then(function(e){var a=JSON.parse(e.data.Content);t.dictionaryList=a})},getList:function(){var t=this;this.listLoading=!0,o(this.listQuery).then(function(e){var a=JSON.parse(e.data.Content);t.list=a.rows,t.total=a.total,t.list.length>0&&t.handleRowClick(t.list[0]),setTimeout(function(){t.listLoading=!1},1e3)})},getStockList:function(){var t=this;k(this.listStockQuery).then(function(e){var a=JSON.parse(e.data.Content);t.stockTotal=a.total,t.StockList=a.rows.map(function(e){return t.checkedStockArray.forEach(function(t){t.Id===e.Id&&(e.Checked=!0,e.PickedQuantity=t.PickedQuantity)}),e})})},handleFilter:function(){this.listQuery.Page=1,this.getList()},handleSizeChange:function(t){this.listQuery.Rows=t,this.getList()},handleCurrentChange:function(t){this.listQuery.Page=t,this.getList()},handleStockFilter:function(){this.listStockQuery.Page=1,this.getStockList()},handleStockSizeChange:function(t){this.listStockQuery.Rows=t,this.getStockList()},handleStockCurrentChange:function(t){this.listStockQuery.Page=t,this.getStockList()},handleCreateTask:function(t){var e=this;this.fullscreenLoading=!0,Object(N["a"])(t).then(function(a){var i=JSON.parse(a.data.Content);i.Success?(e.getList(),e.handleRowClick(t)):e.$message({title:"失败",message:"创建失败："+i.Message,type:"error",duration:5e3}),e.fullscreenLoading=!1})},handleInterfaceCreate:function(){var t=this;O().then(function(e){var a=JSON.parse(e.data.Content);console.log(a),a.Success?(t.dialogFormVisible=!1,t.getList(),t.handleRowClick(t.Out),t.$message({title:"成功",message:a.Message,type:"success",duration:2e3})):t.$message({title:"失败",message:"创建失败："+a.Message,type:"error",duration:2e3})})},handleCreate:function(){var t=this;this.restOut(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},createData:function(){var t=this;this.addMaterial.length<=0?this.$message({title:"失败",message:"请添加物料明细",type:"error",duration:2e3}):this.$refs["dataForm"].validate(function(e){if(e){if(t.Out.AddMaterial=[],t.addMaterial.forEach(function(e){t.Out.AddMaterial.push(e)}),!t.checkItem(t.Out.AddMaterial[t.Out.AddMaterial.length-1]))return;c(t.Out).then(function(e){var a=JSON.parse(e.data.Content);a.Success?(t.dialogFormVisible=!1,t.getList(),t.$message({title:"成功",message:"创建成功",type:"success",duration:2e3}),t.handleRowClick(t.Out)):t.$message({title:"失败",message:"创建失败："+a.Message,type:"error",duration:2e3})})}})},handleCancel:function(t){var e=this;this.$confirm("此操作将作废该出库单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.In=Object.assign({},t),e.cancelData(e.In)}).catch(function(){e.$message({type:"info",message:"已取消作废"})}),this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})},cancelData:function(t){var e=this;S(t).then(function(a){var i=JSON.parse(a.data.Content);i.Success?(e.dialogFormVisible=!1,e.getList(),e.handleRowClick(t),e.$message({title:"成功",message:"出库单作废成功",type:"success",duration:2e3})):e.$message({title:"失败",message:"出库单作废失败："+i.Message,type:"error",duration:2e3})})},handlePrint:function(t){},handleSendPickOrder:function(t){var e=this;this.Out=Object.assign({},t),1===this.Out.Status?m(this.Out).then(function(t){var a=JSON.parse(t.data.Content);a.Success?(e.$message({title:"成功",message:"亮灯任务发送成功",type:"success",duration:2e3}),e.getList()):e.$message({title:"成功",message:"亮灯任务发送失败"+a.Message,type:"error",duration:2e3})}):this.$message({title:"失败",message:"出库单"+this.Out.Code+"状态:["+t.StatusCaption+"]不为待发送",type:"error",duration:2e3})},handleShelfDown:function(t){this.Out=Object.assign({},t),0===this.Out.Status||4===this.Out.Status?this.outMaterialCombineList.length>0&&(this.dialogFormLabel=!0,this.checkedStockArray=[],this.StockList=null):this.$message({title:"失败",message:"出库单"+this.Out.Code+"执行中或已完成",type:"error",duration:2e3})},handleGenerateOutLabel:function(t){var e=this;this.Out=Object.assign({},t),0===this.Out.Status?v(this.Out).then(function(t){var a=JSON.parse(t.data.Content);a.Success?(e.$message({title:"成功",message:"出库条码生成成功",type:"success",duration:2e3}),e.getList()):e.$message({title:"成功",message:"出库条码生成失败:"+a.Message,type:"error",duration:2e3})}):this.$message({title:"失败",message:"出库单"+this.Out.Code+"执行中或已完成",type:"error",duration:2e3})},handleUpdate:function(t){var e=this;this.Out=Object.assign({},t),0===this.Out.Status?(l(t.Code).then(function(t){var a=JSON.parse(t.data.Content);e.addMaterial=a}),p(t.Code).then(function(t){var a=JSON.parse(t.data.Content);e.editMaterialList=a,e.materialList=[],e.editMaterialList.forEach(function(t){e.materialList.push(t)})}),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})):this.$message({title:"失败",message:"出库单"+this.Out.Code+"执行中或已完成",type:"error",duration:2e3})},updateData:function(){var t=this;this.$refs["dataForm"].validate(function(e){if(e){t.Out.AddMaterial=[],t.addMaterial.forEach(function(e){t.Out.AddMaterial.push(e)});var a=Object.assign({},t.Out);h(a).then(function(e){var a=JSON.parse(e.data.Content);a.Success?(t.dialogFormVisible=!1,t.getList(),t.$message({title:"成功",message:"更新成功",type:"success",duration:2e3})):t.$message({title:"失败",message:"创建失败："+a.Message,type:"error",duration:2e3})})}})},handleDelete:function(t){var e=this;this.$confirm("此操作将永久删除该出库单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.Out=Object.assign({},t),e.deleteData(e.Out)}).catch(function(){e.$message({type:"info",message:"已取消删除"})}),this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})},deleteData:function(t){var e=this;d(t).then(function(t){var a=JSON.parse(t.data.Content);a.Success?(e.dialogFormVisible=!1,e.$message({title:"成功",message:"删除成功",type:"success",duration:2e3}),e.getList()):e.$message({title:"成功",message:"删除失败："+a.Message,type:"error",duration:2e3})})},handleRowClick:function(t,e,a){var i=this;l(t.Code).then(function(t){var e=JSON.parse(t.data.Content);i.listMaterial=e}),b(t.Code).then(function(t){var e=JSON.parse(t.data.Content);i.outMaterialCombineList=e})},handleMaterialRowClick:function(t,e,a){this.listStockQuery.MaterialCode=t.MaterialCode,this.listStockQuery.WareHouseCode=t.WareHouseCode,this.getStockList(),this.currentPickMaterial=t},restOut:function(){this.Out={Code:"",BillCode:"",WareHouseCode:"",InDict:void 0,Remark:"",AddMaterial:[],Status:void 0,PickedStockList:[]},this.addMaterial=[]},handleCreateOutMaterial:function(){var t=this;if(""!==this.Out.WareHouseCode){if(i>1){var e=this.addMaterial[this.addMaterial.length-1];if(!this.checkItem(e))return}var a=this.addMaterial.length+1,i=this.addMaterial.length+1,n=0;this.addMaterial.length>0&&this.addMaterial.forEach(function(e){if(n+=1,n===t.addMaterial.length){var i=parseInt(e.ItemNo);a=(i+1).toString()}});var r={MaterialCode:"",MaterialName:"",BatchCode:"",Quantity:0,MaterialLabel:"",Id:i,Status:0,ItemNo:a.toString().padStart(6,"0"),AvailableStock:0};this.addMaterial.push(r)}else this.$message({title:"提示",message:"请选择仓库",type:"warning",duration:2e3})},remoteMethod:function(t){var e=this;""!==t?(this.loading=!0,s(t).then(function(t){var a=JSON.parse(t.data.Content);e.materialList=a}),setTimeout(function(){e.loading=!1},200)):(this.materialList=[],this.editMaterialList.forEach(function(t){e.materialList.push(t)}))},materialCodeChange:function(t){this.addMaterial.find(function(e){return e.MaterialCode===t.MaterialCode}).MaterialTypeDescription=this.materialList.find(function(e){return e.Code===t.MaterialCode}).MaterialTypeDescription,g(t.MaterialCode,this.Out.WareHouseCode).then(function(e){t.AvailableStock=e.data})},handleDeleteOutMaterial:function(){void 0!==this.addMaterialGridCurrentRowIndex&&this.addMaterial.splice(this.addMaterial.indexOf(this.addMaterialGridCurrentRowIndex),1)},addMaterialGridClick:function(t,e,a){this.addMaterialGridCurrentRowIndex=t},GetWareHouseList:function(){var t=this;u().then(function(e){var a=JSON.parse(e.data.Content);t.WareHouseList=a})},confirmPicked:function(){var t=this;this.checkedStockArray.length<=0?this.$message({title:"失败",message:"未选择任何条码",type:"error",duration:2e3}):(this.Out.PickedStockList=[],this.checkedStockArray.forEach(function(e){t.Out.PickedStockList.push(e)}),y(this.Out).then(function(e){var a=JSON.parse(e.data.Content);a.Success?(t.dialogFormVisible=!1,t.$message({title:"成功",message:"拣选成功",type:"success",duration:2e3}),t.getList(),t.dialogFormLabel=!1):t.$message({title:"成功",message:"拣选失败"+a.Message,type:"error",duration:2e3})}))},doStockCheck:function(t){var e=this;if(t.Checked)if(void 0!==t.PickedQuantity){var a=parseFloat(t.PickedQuantity);if(isNaN(a)||"Nan"===a||0===a)return this.$message({message:"拣选重量(g)必须为数值或者不为0",type:"error",duration:2e3}),t.PickedQuantity=0,void(t.Checked=!1);var i=this.currentPickMaterial.Quantity-this.currentPickMaterial.PickedQuantity;if(a>i)return this.$message({message:"拣选重量(g)必须为小于需求重量(g)",type:"error",duration:2e3}),t.PickedQuantity=0,void(t.Checked=!1);if(t.Quantity-t.LockedQuantity-a<0)return this.$message({message:"拣选重量(g)应小于可用库存重量(g)",type:"error",duration:2e3}),t.PickedQuantity=0,void(t.Checked=!1);this.currentPickMaterial.PickedQuantity=this.currentPickMaterial.PickedQuantity+a,this.checkedStockArray.push(t)}else this.$message({message:"请输入拣选重量(g)",type:"error",duration:2e3}),t.Checked=!1,t.PickedQuantity=0;else{this.checkedStockArray.forEach(function(t){t.MaterialCode===e.currentPickMaterial.MaterialCode&&(e.currentPickMaterial.PickedQuantity=e.currentPickMaterial.PickedQuantity-t.PickedQuantity)});for(var n=0;n<this.checkedStockArray.length;n++)if(this.checkedStockArray[n].Id===t.Id){this.checkedStockArray.splice(n,1);break}t.Checked=!1}},handleCheck:function(t){this.Out=Object.assign({},t),0!==this.Out.Status?5===this.Out.Status?(this.GetCheckedAndWaitingCheckingLabel(),this.dialogFormCheck=!0):this.$message({title:"失败",message:"出库单"+this.Out.Code+"尚未完成拣货或已复核完毕",type:"error",duration:2e3}):this.$message({title:"失败",message:"出库单"+this.Out.Code+"尚未开始拣货",type:"error",duration:2e3})},GetCheckedAndWaitingCheckingLabel:function(){this.GetCheckedLabel(),this.GetWaitingCheckingLabel()},GetWaitingCheckingLabel:function(){var t=this,e=this.searchMaterialLabel;this.searchMaterialLabel="";var a=this.$refs.materialLabel;void 0!==a&&a.focus(),C(this.Out.Code,5,e).then(function(e){var a=JSON.parse(e.data.Content);0===a.length?C(t.Out.Code,5,"").then(function(e){var a=JSON.parse(e.data.Content);t.WaitingForCheckLabelList=a.map(function(t){return t.CheckedQuantity=t.RealPickedQuantity,t})}):t.WaitingForCheckLabelList=a.map(function(t){return t.CheckedQuantity=t.RealPickedQuantity,t}),0===t.WaitingForCheckLabelList.length&&(t.dialogFormCheck=!1,t.getList(),t.$message({title:"成功",message:"出库单"+t.Out.Code+"出库成功",type:"success",duration:2e3}))})},GetCheckedLabel:function(){var t=this;C(this.Out.Code,6,this.searchMaterialLabel).then(function(e){var a=JSON.parse(e.data.Content);t.CheckedLabelList=a})},handConfirmCheck:function(t){var e=this;if(void 0!==t.CheckedQuantity){var a=parseFloat(t.CheckedQuantity);isNaN(a)||"Nan"===a||0===a?this.$message({message:"复核重量(g)必须为数值或者不为0",type:"error",duration:2e3}):a>t.RealPickedQuantity?this.$message({message:"复核重量(g)必须为小于或等于拣选重量(g)",type:"error",duration:2e3}):_(t).then(function(t){var a=JSON.parse(t.data.Content);a.Success?(e.dialogFormVisible=!1,e.GetCheckedAndWaitingCheckingLabel(),e.$message({title:"成功",message:"复核成功",type:"success",duration:2e3})):e.$message({title:"失败",message:"复核失败"+a.Message,type:"error",duration:2e3})})}else this.$message({message:"请确认复核重量(g)",type:"error",duration:2e3})},beforeUpload:function(t){var e="application/vnd.ms-excel"===t.type,a="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.type;return e|a},handleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，请删除后继续上传")},uploadFile:function(t){var e=this,a=t.file,i=new FormData;i.append("file",a),i.append("comId",this.comId),console.log(JSON.stringify(i)),w(i).then(function(t){var a=JSON.parse(t.data.Content);a.Success?(e.dialogFormVisible=!1,e.getList(),e.$message({title:"成功",message:"导入成功",type:"success",duration:2e3})):e.$message({title:"失败",message:"导入失败"+a.Message,type:"error",duration:2e3})})},handleDownUpload:function(){var t=window.PLATFROM_CONFIG.baseUrl+"/api/Out/DoDownLoadTemp";window.open(t)},handleCheckLabel:function(){var t=this;Object(x["n"])(this.Label.Code).then(function(e){var a=JSON.parse(e.data.Content);t.Label=a})},handleAddLabel:function(){var t=this.addMaterialLabel.length+1,e={MaterialCode:this.Label.MaterialCode,MaterialName:this.Label.MaterialName,BatchCode:this.Label.Batchcode,Quantity:this.Label.Quantity,MaterialLabel:this.Label.MaterialLabel,LocationCode:this.Label.LocationCode,Id:t,Status:0};this.addMaterialLabel.push(e);var a={Id:this.Label.Id,MaterialCode:this.Label.MaterialCode,BatchCode:this.Label.Batchcode,LocationCode:this.Label.LocationCode,MaterialLabel:this.Label.MaterialLabel,Quantity:this.Label.Quantity,PickedQuantity:this.Label.Quantity};this.Out.PickedStockList.push(a),this.Label={Code:null,SupplyCode:null,MaterialCode:null,ProductionDate:null,Batchcode:null}},createLabelData:function(){var t=this;this.Out.AddMaterial=[],this.Out.Status=0,this.addMaterialLabel.forEach(function(e){t.Out.AddMaterial.length>0?t.Out.AddMaterial.forEach(function(a){e.MaterialCode===a.MaterialCode?a.Quantity=a.Quantity+e.Quantity:t.Out.AddMaterial.push(e)}):t.Out.AddMaterial.push(e)}),this.Out.OutDict="GetRerurn",c(this.Out).then(function(e){var a=JSON.parse(e.data.Content);a.Success?(t.Out.Code=a.Data.Code,y(t.Out).then(function(e){var i=JSON.parse(e.data.Content);i.Success?t.addMaterialLabel.forEach(function(e){e.OutCode=t.Out.Code,e.CheckedQuantity=e.Quantity,_(e).then(function(e){var i=JSON.parse(e.data.Content);i.Success?(t.dialogOutMaterialVisible=!1,t.$message({title:"成功",message:"复核成功",type:"success",duration:2e3})):t.$message({title:"失败",message:"复核失败"+a.Message,type:"error",duration:2e3})})}):t.$message({title:"成功",message:"拣选失败"+a.Message,type:"error",duration:2e3})})):t.$message({title:"失败",message:"创建失败："+a.Message,type:"error",duration:2e3})})},checkItem:function(t){return""===t.MaterialCode?(this.$message({title:"成功",message:"请选择物料",type:"error",duration:2e3}),!1):0!==t.Quantity||(this.$message({title:"成功",message:"请输入重量(g)",type:"error",duration:2e3}),!1)},changeWarehouse:function(){this.addMaterial=[]}}},Q=P,F=a("2877"),$=Object(F["a"])(Q,i,n,!1,null,null,null);e["default"]=$.exports}}]);