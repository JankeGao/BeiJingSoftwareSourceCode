(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ccead10"],{"0b2e":function(e,t,a){"use strict";var r=a("a0f3"),o=a.n(r);o.a},5142:function(e,t,a){"use strict";a.d(t,"b",function(){return o}),a.d(t,"d",function(){return n}),a.d(t,"a",function(){return s}),a.d(t,"c",function(){return i});var r=a("b775");function o(){return Object(r["a"])({url:"api/Authorization/GetModuleList",method:"get"})}function n(e){return Object(r["a"])({url:"api/Authorization/PostSetAuthorization",method:"post",data:{ModuleAuthJson:JSON.stringify(e.arr),TypeCode:e.typeCode,Type:e.type}})}function s(e,t){return Object(r["a"])({url:"api/Authorization/GetModuleAuth",method:"get",params:{typeCode:e,type:t}})}function i(e,t){return Object(r["a"])({url:"api/Authorization/GetModuleUserRoleAuth",method:"get",params:{typeCode:e,type:t}})}},"5c83":function(e,t,a){"use strict";a("a481"),a("6762"),a("2fdb");var r={bind:function(e,t,a){var r=e.querySelector(".el-dialog__header"),o=e.querySelector(".el-dialog");r.style.cssText+=";cursor:move;",o.style.cssText+=";top:0px;";var n=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}();r.onmousedown=function(e){var t=e.clientX-r.offsetLeft,s=e.clientY-r.offsetTop,i=o.offsetWidth,l=o.offsetHeight,u=document.body.clientWidth,c=document.body.clientHeight,d=o.offsetLeft,f=u-o.offsetLeft-i,p=o.offsetTop,h=c-o.offsetTop-l,m=n(o,"left"),g=n(o,"top");m.includes("%")?(m=+document.body.clientWidth*(+m.replace(/\%/g,"")/100),g=+document.body.clientHeight*(+g.replace(/\%/g,"")/100)):(m=+m.replace(/\px/g,""),g=+g.replace(/\px/g,"")),document.onmousemove=function(e){var r=e.clientX-t,n=e.clientY-s;-r>d?r=-d:r>f&&(r=f),-n>p?n=-p:n>h&&(n=h),o.style.cssText+=";left:".concat(r+m,"px;top:").concat(n+g,"px;"),a.child.$emit("dragDialog")},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}},o=function(e){e.directive("el-drag-dialog",r)};window.Vue&&(window["el-drag-dialog"]=r,Vue.use(o)),r.install=o;t["a"]=r},"62a2":function(e,t,a){"use strict";a.d(t,"B",function(){return o}),a.d(t,"u",function(){return n}),a.d(t,"v",function(){return s}),a.d(t,"e",function(){return i}),a.d(t,"p",function(){return l}),a.d(t,"l",function(){return u}),a.d(t,"m",function(){return c}),a.d(t,"j",function(){return d}),a.d(t,"g",function(){return f}),a.d(t,"h",function(){return p}),a.d(t,"i",function(){return h}),a.d(t,"A",function(){return m}),a.d(t,"q",function(){return g}),a.d(t,"y",function(){return b}),a.d(t,"n",function(){return v}),a.d(t,"o",function(){return y}),a.d(t,"k",function(){return C}),a.d(t,"d",function(){return w}),a.d(t,"f",function(){return U}),a.d(t,"w",function(){return k}),a.d(t,"x",function(){return O}),a.d(t,"c",function(){return _}),a.d(t,"z",function(){return S}),a.d(t,"r",function(){return x}),a.d(t,"s",function(){return P}),a.d(t,"b",function(){return D}),a.d(t,"a",function(){return j}),a.d(t,"D",function(){return T}),a.d(t,"C",function(){return R}),a.d(t,"t",function(){return L});var r=a("b775");function o(e){return Object(r["a"])({url:"api/WareHouse/GetWareHouseTreeData",method:"get",params:{type:e}})}function n(e){return Object(r["a"])({url:"api/WareHouse/GetMaterialPageRecords",method:"get",params:e})}function s(e){return Object(r["a"])({url:"api/WareHouse/GetPageRecords",method:"get",params:e})}function i(e){return Object(r["a"])({url:"api/WareHouse/PostDoCreateWareHouse",method:"post",data:e})}function l(e){return Object(r["a"])({url:"api/WareHouse/PostDoEditWareHouse",method:"post",data:e})}function u(e){return Object(r["a"])({url:"api/WareHouse/PostDoEditContainer",method:"post",data:e})}function c(e){return Object(r["a"])({url:"api/WareHouse/PostDoEditLocation",method:"post",data:e})}function d(e){return Object(r["a"])({url:"api/WareHouse/PostDoDeleteWareHouse",method:"post",data:e})}function f(e){return Object(r["a"])({url:"api/WareHouse/PostDoDeleteContainer",method:"post",data:e})}function p(e){return Object(r["a"])({url:"api/WareHouse/PostDoDeleteLocation",method:"post",data:e})}function h(e){return Object(r["a"])({url:"api/WareHouse/PostDoDeleteTray",method:"post",data:e})}function m(e){return Object(r["a"])({url:"api/WareHouse/GetWareHouseLocations",method:"get",params:{KeyValue:e}})}function g(e){return Object(r["a"])({url:"api/WareHouse/GetAreaLocations",method:"get",params:{KeyValue:e}})}function b(e){return Object(r["a"])({url:"api/WareHouse/GetTrayLocations",method:"get",params:{KeyValue:e}})}function v(e){return Object(r["a"])({url:"api/WareHouse/PostDoEditTray",method:"post",data:e})}function y(e){return Object(r["a"])({url:"api/WareHouse/PostDoEditTrayLocation",method:"post",data:e})}function C(e){return Object(r["a"])({url:"api/WareHouse/PostDoDeleteLocationByLayoutId",method:"post",data:e})}function w(e){return Object(r["a"])({url:"api/WareHouse/PostDoCreateContainer",method:"post",data:e})}function U(e){return Object(r["a"])({url:"api/WareHouse/PostDoCreateTray",method:"post",data:e})}function k(e){return Object(r["a"])({url:"api/WareHouse/GetTrayById",method:"get",params:{trayId:e}})}function O(e){return Object(r["a"])({url:"api/WareHouse/GetTrayLayoutById",method:"get",params:{trayId:e}})}function _(e){return Object(r["a"])({url:"api/WareHouse/AddBatchTrayUserMap",method:"post",data:e})}function S(e){return Object(r["a"])({url:"api/WareHouse/GetTrayUserMapByTrayId",method:"get",params:{trayId:e}})}function x(e){return Object(r["a"])({url:"api/WareHouse/GetDoCheckAuth",method:"get",params:{trayId:e}})}function P(e){return Object(r["a"])({url:"api/WareHouse/GetLocationByLayoutId",method:"get",params:{layoutId:e}})}function D(e){return Object(r["a"])({url:"api/WareHouse/PostStartContainer",method:"post",data:e})}function j(e){return Object(r["a"])({url:"api/WareHouse/PostRestoreContainer",method:"post",data:e})}function T(e){return Object(r["a"])({url:"api/WareHouse/PostDoDeleteLocationByTrayId",method:"post",data:e})}function R(e){return Object(r["a"])({url:"api/WareHouse/DoUpLoadInInfo",method:"post",data:e})}function L(e){return Object(r["a"])({url:"api/WareHouse/GetLocationByTrayId",method:"get",params:{trayId:e}})}},6724:function(e,t,a){"use strict";a("8d41");var r="@@wavesContext";function o(e,t){function a(a){var r=Object.assign({},t.value),o=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},r),n=o.ele;if(n){n.style.position="relative",n.style.overflow="hidden";var s=n.getBoundingClientRect(),i=n.querySelector(".waves-ripple");switch(i?i.className="waves-ripple":(i=document.createElement("span"),i.className="waves-ripple",i.style.height=i.style.width=Math.max(s.width,s.height)+"px",n.appendChild(i)),o.type){case"center":i.style.top=s.height/2-i.offsetHeight/2+"px",i.style.left=s.width/2-i.offsetWidth/2+"px";break;default:i.style.top=(a.pageY-s.top-i.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",i.style.left=(a.pageX-s.left-i.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return i.style.backgroundColor=o.color,i.className="waves-ripple z-active",!1}}return e[r]?e[r].removeHandle=a:e[r]={removeHandle:a},a}var n={bind:function(e,t){e.addEventListener("click",o(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[r].removeHandle,!1),e.addEventListener("click",o(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[r].removeHandle,!1),e[r]=null,delete e[r]}},s=function(e){e.directive("waves",n)};window.Vue&&(window.waves=n,Vue.use(s)),n.install=s;t["a"]=n},"8d41":function(e,t,a){},a0f3:function(e,t,a){},a2ec:function(e,t,a){"use strict";a.d(t,"e",function(){return o}),a.d(t,"d",function(){return n}),a.d(t,"a",function(){return s}),a.d(t,"c",function(){return i}),a.d(t,"b",function(){return l});var r=a("b775");function o(){return Object(r["a"])({url:"api/Role/GetRole",method:"get",params:{}})}function n(e){return Object(r["a"])({url:"api/Role/GetRoleList",method:"get",params:e})}function s(e){return Object(r["a"])({url:"api/Role/PostDoCreate",method:"post",data:e})}function i(e){return Object(r["a"])({url:"api/Role/PostDoEdit",method:"post",data:e})}function l(e){return Object(r["a"])({url:"api/Role/PostDoRemove",method:"post",data:e})}},cbe9:function(e,t,a){"use strict";a.d(t,"j",function(){return o}),a.d(t,"h",function(){return n}),a.d(t,"a",function(){return s}),a.d(t,"c",function(){return i}),a.d(t,"b",function(){return l}),a.d(t,"g",function(){return u}),a.d(t,"e",function(){return c}),a.d(t,"i",function(){return d}),a.d(t,"f",function(){return f}),a.d(t,"d",function(){return p});var r=a("b775");function o(e){return Object(r["a"])({url:"api/User/GetUserList",method:"get",params:e})}function n(){return Object(r["a"])({url:"api/User/GetUserInfos",method:"get"})}function s(e){return Object(r["a"])({url:"api/User/PostDoCreate",method:"post",data:e})}function i(e){return Object(r["a"])({url:"api/User/PostDoEdit",method:"post",data:e})}function l(e){return Object(r["a"])({url:"api/User/PostDoRemove",method:"post",data:e})}function u(e){return Object(r["a"])({url:"api/User/GetUserInfo",method:"get",params:{code:e}})}function c(e){return Object(r["a"])({url:"api/User/PostDoEditUserCenter",method:"post",data:e})}function d(e){return Object(r["a"])({url:"api/User/GetUserlInfoList",method:"get",params:{KeyValue:e}})}function f(e){return Object(r["a"])({url:"api/User/GetUserInfoByRole",method:"get",params:{role:e}})}function p(e){return Object(r["a"])({url:"api/User/PostDoEditUserArea",method:"post",data:e})}},f2e3:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"search-card"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",attrs:{placeholder:"姓名",clearable:""},on:{clear:e.handleFilter},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.Name,callback:function(t){e.$set(e.listQuery,"Name",t)},expression:"listQuery.Name"}}),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("查询")]),e._v(" "),a("el-button",{staticClass:"filter-button",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("添加")])],1)]),e._v(" "),a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%","min-height":"100%"},attrs:{data:e.list,"header-cell-style":{background:"#F5F7FA"},border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户名",width:"150px",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.Code))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.Name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用户组",align:"left","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.Role,function(t){return a("span",{key:t.Id,staticStyle:{margin:"3px"}},[a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.Name))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"员工卡号",width:"180px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.RFIDCode))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"手机",width:"180px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.Mobilephone))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"性别",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.SexCaption))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"启用",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:""},model:{value:t.row.Enabled,callback:function(a){e.$set(t.row,"Enabled",a)},expression:"scope.row.Enabled "}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",width:"150px",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.CreatedUserName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建日期",width:"200px",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.CreatedTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"220","class-name":"small-padding fixed-width",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("编辑")])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleAuthorization(t.row)}}},[e._v("授权")])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.row,"deleted")}}},[e._v("删除")])],1)],1)]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.listQuery.Page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.Rows,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{visible:e.dialogFormVisible,width:"60%","close-on-click-modal":!1,title:e.textMap[e.dialogStatus]},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticClass:"page-form",attrs:{model:e.User,rules:e.rules,"status-icon":"","label-width":"100px","label-position":"right"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"item",attrs:{label:"用户名:",prop:"Code"}},[a("el-input",{staticClass:"dialog-input",attrs:{placeholder:"请输入用户名",disabled:"update"===e.dialogStatus},model:{value:e.User.Code,callback:function(t){e.$set(e.User,"Code",t)},expression:"User.Code"}})],1),e._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"员工卡号:"}},[a("el-input",{staticClass:"dialog-input",attrs:{placeholder:"请输入员工卡号",onkeyup:"value=value.replace(/[^\\d]/g,'')",maxlength:"11"},model:{value:e.User.RFIDCode,callback:function(t){e.$set(e.User,"RFIDCode",t)},expression:"User.RFIDCode"}})],1),e._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"手机:"}},[a("el-input",{staticClass:"dialog-input",attrs:{placeholder:"请输入手机号码",onkeyup:"value=value.replace(/[^\\d]/g,'')",maxlength:"11"},model:{value:e.User.Mobilephone,callback:function(t){e.$set(e.User,"Mobilephone",t)},expression:"User.Mobilephone"}})],1),e._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"密码:",prop:"Password"}},["create"===e.dialogStatus?a("div",[a("el-tooltip",{attrs:{effect:"light",content:"默认密码为：123456",placement:"right"}},[a("el-input",{staticClass:"dialog-input",attrs:{type:"password","auto-complete":"off"},model:{value:e.User.Password,callback:function(t){e.$set(e.User,"Password",t)},expression:"User.Password"}})],1)],1):a("div",[a("el-input",{staticClass:"dialog-input",attrs:{type:"password","auto-complete":"off"},on:{change:e.changePassword},model:{value:e.User.Password,callback:function(t){e.$set(e.User,"Password",t)},expression:"User.Password"}})],1)]),e._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"确认密码:",prop:"checkPass"}},[a("el-input",{staticClass:"dialog-input",attrs:{type:"password","auto-complete":"off"},model:{value:e.User.checkPass,callback:function(t){e.$set(e.User,"checkPass",t)},expression:"User.checkPass"}})],1),e._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"用户组:",prop:"Role"}},[[a("div",[a("el-checkbox-group",{attrs:{size:"medium"},on:{change:e.selectedRole},model:{value:e.User.Roles,callback:function(t){e.$set(e.User,"Roles",t)},expression:"User.Roles"}},e._l(e.roleList,function(t){return a("el-checkbox-button",{key:t.Code,attrs:{label:t.Code}},[e._v(e._s(t.Name))])}),1)],1)]],2),e._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"姓名:",prop:"Name"}},[a("el-input",{staticClass:"dialog-input",attrs:{placeholder:"请输入姓名"},model:{value:e.User.Name,callback:function(t){e.$set(e.User,"Name",t)},expression:"User.Name"}})],1),e._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"性别:"}},[a("el-radio-group",{on:{change:e.selectedSex},model:{value:e.User.Sex,callback:function(t){e.$set(e.User,"Sex",t)},expression:"User.Sex"}},[a("el-radio",{attrs:{label:"1"}},[e._v("男")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("女")])],1)],1),e._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"启用:"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.User.Enabled,callback:function(t){e.$set(e.User,"Enabled",t)},expression:"User.Enabled"}})],1)],1),e._v(" "),"update"==e.dialogStatus?a("el-col",{attrs:{span:12}},[a("img",{staticClass:"image",staticStyle:{height:"100%",width:"100%",display:"block"},attrs:{src:e.faceUrl,fit:"fit"}}),e._v(" "),a("div",{staticStyle:{margin:"20px 0px"}},[e._v("人脸照片需小于200k")]),e._v(" "),a("el-upload",{staticClass:"filter-button",attrs:{"show-file-list":!1,"on-success":e.uploadingPicture,action:e.uploadFileLibrary,"before-upload":e.PictureStatus,data:{Id:e.User.Id}}},[a("el-button",{staticStyle:{"margin-bottom":"70px"}},[e._v("上传人脸图片")])],1)],1):e._e()],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),"create"==e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:e.createUser}},[e._v("确认")]):a("el-button",{attrs:{type:"primary"},on:{click:e.updateUser}},[e._v("确认")])],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"用户授权--"+e.User.Name,visible:e.dialogTreeVisible,"close-on-click-modal":!1,fullscreen:!0},on:{"update:visible":function(t){e.dialogTreeVisible=t}}},[a("div",{staticStyle:{height:"75vh"}},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClickTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticStyle:{height:"65vh"},attrs:{label:"功能权限",name:"first"}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-form",{ref:"treeDataForm"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-card",{staticClass:"box-card"},[a("el-tree",{ref:"tree",attrs:{props:e.treeProps,data:e.treeData,"default-checked-keys":e.moduleAuthData,"check-strictly":!0,"node-key":"Code","show-checkbox":"","default-expand-all":!0}})],1)],1)],1)],1)],1)],1),e._v(" "),a("el-tab-pane",{staticStyle:{height:"70vh"},attrs:{label:"仓库权限",name:"second"}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("div",[a("span",[a("div",{staticStyle:{display:"inline-block"}},[a("h4",[e._v("库存管理区域")])])])]),e._v(" "),a("hr",{staticClass:"line"}),e._v(" "),a("div",[a("el-tree",{ref:"treeTest",staticStyle:{"font-size":"20px"},attrs:{data:e.warehouseTreeData,"expand-on-click-node":!1,"node-key":"Id","highlight-current":"","show-checkbox":"","default-expand-all":""},on:{"check-change":e.handleCheckStockChange}})],1)])],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTreeVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.setAuthorization}},[e._v("确认")])],1)])],1)},o=[],n=(a("a481"),a("28a5"),a("7f7f"),a("ac6a"),a("cbe9")),s=a("62a2"),i=a("a2ec"),l=a("8237"),u=a.n(l),c=a("6724"),d=a("5c83"),f=a("5142"),p={name:"User",directives:{elDragDialog:d["a"],waves:c["a"]},data:function(){var e=this,t=function(e,t,a){""===t?a(new Error("请输入密码")):t.length<5?a(new Error("密码不能小于5位")):a()},a=function(t,a,r){""===a?r(new Error("请再次输入密码")):a!==e.User.Password?r(new Error("两次输入密码不一致!")):r()},r=function(t,a,r){0===e.User.Roles.length?r(new Error("请至少选择一个角色")):r()},o=function(t,a,r){""===a?r(new Error("请输入手机号码")):(e.User.Mobilephone.length<6&&r(new Error("请输入正确手机号码")),r())};return{warehouseTreeData:[],tableKey:0,list:null,total:null,listLoading:!0,listQuery:{Page:1,Rows:12,Name:void 0,type:void 0,Sort:"id"},isChangePassword:!1,User:{Id:void 0,Code:"",Name:"",Password:"123456",checkPass:"123456",Sex:"1",Mobilephone:"",Roles:[],WeXin:"",Remark:"",Header:window.PLATFROM_CONFIG.baseUrl+"/Assets/images/3.png",Enabled:!0},roleList:[],rules:{Code:[{required:!0,message:"请输入用户编码",trigger:"blur"}],Name:[{required:!0,message:"请输入用户姓名",trigger:"blur"}],Role:[{required:!0,validator:r,trigger:"change"}],Mobilephone:[{required:!0,validator:o,trigger:"blur",min:6,max:11}],Password:[{validator:t,trigger:"blur"}],checkPass:[{required:!0,validator:a,trigger:"blur"}]},dialogTreeVisible:!1,moduleAuthData:[1],treeProps:{label:"Name",children:"children"},treeData:[],ModuleAuths:{arr:[],typeCode:"",type:1},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑用户",create:"创建用户"},src:"/logo.png",faceUrl:"",uploadFileLibrary:window.PLATFROM_CONFIG.baseUrl+"/api/FileLibrary/PostDoFaceLibraryUpload1",BaseUrl:window.PLATFROM_CONFIG.baseUrl,activeName:"first"}},watch:{dialogFormVisible:function(e){e||this.resetUser()},dialogTreeVisible:function(e){e||this.resetUser()}},created:function(){this.initData()},methods:{initData:function(){this.getList(),this.getRoleList()},getList:function(){var e=this;this.listLoading=!0,Object(n["j"])(this.listQuery).then(function(t){var a=JSON.parse(t.data.Content);e.list=a.rows,e.total=a.total,setTimeout(function(){e.listLoading=!1},1e3)})},getRoleList:function(){var e=this;Object(i["e"])().then(function(t){if(200===t.status){var a=JSON.parse(t.data.Content);a.forEach(function(t){e.roleList.push(t)})}else e.$message({title:"失败",message:"获取角色信息失败："+a.Message,type:"error",duration:2e3})})},handleFilter:function(){this.listQuery.Page=1,this.getList()},handleSizeChange:function(e){this.listQuery.Rows=e,this.getList()},handleCurrentChange:function(e){this.listQuery.Page=e,this.getList()},getWareHouse:function(){var e=this;Object(s["B"])(1).then(function(t){var a=JSON.parse(t.data.Content);e.warehouseTreeData=e.convertTreeData2(a)})},convertTreeData1:function(e){var t=this,a=[],r={Code:"WareHouse",Name:"仓库信息"},o=this.generateRouter1(r,!0,0),n=[];return e.forEach(function(e){var a=t.generateRouter1(e,!0,1),r=[],o=[];r=e.ContainerList;var s=[];s=e.LocationList,r.forEach(function(e){var a=[];s.forEach(function(t){t.AreaCode===e.Code&&(t.WareHouseCode,e.WareHouseCode)});var r=t.generateRouter1(e,!1,2);r.children=a,o.push(r)}),a.children=o,n.push(a)}),o.children=n,a.push(o),a},handleClickTab:function(e){"second"===e.name&&this.setCheckedStockNodes(this.User.StockArea)},setCheckedStockNodes:function(e){var t=this;if(null!=e){var a=e.split(",");console.log(a),this.$nextTick(function(){var e=[];a.forEach(function(t){""!=t&&e.push(t)}),t.$refs["treeTest"].setCheckedKeys(e)})}},handleCheckStockChange:function(e,t,a){var r=this,o=this.$refs["treeTest"].getCheckedNodes(),n="";this.$nextTick(function(){o.forEach(function(e){3===e.Level&&(n=n+e.Id+",")}),r.User.StockArea=n})},handleCreate:function(){var e=this;this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})},createUser:function(){var e=this;this.$refs["dataForm"].validate(function(t){t&&(e.User.Password=u()(e.User.Password),e.User.Roles=JSON.stringify(e.User.Roles),e.User.Header="/Assets/images/3.png",Object(n["a"])(e.User).then(function(t){var a=JSON.parse(t.data.Content);a.Success?(e.$message({title:"成功",message:"用户创建成功",type:"success",duration:2e3}),e.getList(),e.dialogFormVisible=!1):e.$message({title:"失败",message:"用户创建失败："+a.Message,type:"error",duration:2e3})}))})},handleUpdate:function(e){var t=this,a=Object.assign({},e);a.checkPass=a.Password,a.Roles=[],this.User=a;var r="data:image/png;base64,"+this.User.Remark;this.faceUrl=r.replace(/[\r\n]/g,""),2===this.User.Sex?this.User.Sex="2":this.User.Sex="1",this.User.Role.forEach(function(e){t.User.Roles.push(e.Code)}),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},updateUser:function(){var e=this;this.$refs["dataForm"].validate(function(t){t&&(e.isChangePassword&&(e.User.Password=u()(e.User.Password)),e.User.Roles=JSON.stringify(e.User.Roles),Object(n["c"])(e.User).then(function(t){var a=JSON.parse(t.data.Content);a.Success?(e.$message({title:"成功",message:"用户编辑成功",type:"success",duration:2e3}),e.getList(),e.dialogFormVisible=!1):e.$message({title:"失败",message:"用户编辑失败："+a.Message,type:"error",duration:2e3})}))})},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.User=Object.assign({},e),t.deleteData(t.User)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},deleteData:function(e){var t=this;Object(n["b"])(e).then(function(e){var a=JSON.parse(e.data.Content);a.Success?(t.$message({title:"成功",message:"删除成功",type:"success",duration:2e3}),t.getList()):t.$message({title:"成功",message:"删除失败："+a.Message,type:"error",duration:2e3})})},selectedRole:function(e){this.User.Roles=e},selectedSex:function(e){this.User.Sex=e},changePassword:function(){this.isChangePassword=!0},PictureStatus:function(e){this.JudgeFileLibraty=!0},uploadingPicture:function(e){var t=JSON.parse(e.Content);if(t.Success){this.User.PictureUrl=t.Data.FilePath;var a="data:image/png;base64,"+t.Data.Remark;this.faceUrl=a.replace(/[\r\n]/g,""),this.User.Remark=t.Data.Remark,this.User.FileID=t.Data.Id}else this.$message({})},handleAuthorization:function(e){var t=this;this.User=Object.assign({},e),this.getWareHouseTreeData(),this.getModuleList(),this.getModuleAuth(this.User.Code),this.dialogTreeVisible=!0,this.$nextTick(function(){t.$refs["treeDataForm"].clearValidate()})},getModuleList:function(){var e=this;Object(f["b"])().then(function(t){var a=JSON.parse(t.data.Content);e.treeData=e.convertTreeData(a),setTimeout(function(){},500)})},convertTreeData:function(e){var t=this,a=[],r=e;return"[]"!==JSON.stringify(r)&&r.forEach(function(e){if(null===e.ParentCode||""===e.ParentCode){var o=t.generateRouter(e,!0),n=[];r.forEach(function(a){a.ParentCode===e.Code&&(n.push(t.generateRouter(a,!1)),o.children=n)}),a.push(o)}}),a},generateRouter:function(e,t){var a={Code:e.Code,Name:e.Name};return a},getModuleAuth:function(e){var t=this;Object(f["c"])(e,1).then(function(e){var a=JSON.parse(e.data.Content),r=[],o=t.treeData;a.forEach(function(e){o.forEach(function(t){t.Code===e.Code&&1===e.Type&&(console.log(t.Code),t.disabled=!0),t.children.forEach(function(t){e.Code===t.Code&&1===e.Type&&(t.disabled=!0)})}),r.push(e.Code)}),t.moduleAuthData=r})},setAuthorization:function(){for(var e=this,t=this.$refs.tree.getCheckedKeys(),a=0;a<t.length;a++){var r=Object.create(null);r.Type=1,r.TypeCode=this.User.Code,r.ModuleCode=t[a],this.ModuleAuths.arr.push(r)}this.ModuleAuths.typeCode=this.User.Code,this.ModuleAuths.type=5,Object(f["d"])(this.ModuleAuths).then(function(t){var a=JSON.parse(t.data.Content);a.Success?Object(n["d"])(e.User).then(function(t){var a=JSON.parse(t.data.Content);a.Success?(e.$message({title:"成功",message:"用户授权成功",type:"success",duration:2e3}),e.dialogTreeVisible=!1,window.location.reload()):e.$message({title:"失败",message:"用户授权失败："+a.Message,type:"error",duration:2e3})}):e.$message({title:"成功",message:"创建失败："+a.Message,type:"error",duration:2e3})})},resetUser:function(){this.User={Id:void 0,Code:"",Name:"",Password:"123456",checkPass:"123456",Sex:"1",Mobilephone:"",Roles:[],WeXin:"",Remark:"",Header:window.PLATFROM_CONFIG.baseUrl+"/Assets/images/3.png",Enabled:!0},this.moduleAuthData=[],this.treeData=[]},getWareHouseTreeData:function(){var e=this;Object(s["B"])(1).then(function(t){var a=JSON.parse(t.data.Content);e.warehouseTreeData=e.convertTreeData2(a),console.log(e.warehouseTreeData)})},convertTreeData2:function(e){var t=this,a=[],r={Code:"WareHouse",Name:"仓库信息"},o=this.generateRouter2(r,!0,0),n=[];return e.forEach(function(e){var a=t.generateRouter2(e,!0,1),r=[],o=[];r=e.ContainerList;var s=[];s=e.TrayList,r.forEach(function(e){var a=[];s.forEach(function(r){r.ContainerCode===e.Code&&r.WareHouseCode===e.WareHouseCode&&a.push(t.generateRouter2(r,!1,3))});var r=t.generateRouter2(e,!1,2);r.children=a,o.push(r)}),a.children=o,n.push(a)}),o.children=n,a.push(o),a},generateRouter2:function(e,t,a){1===a&&(e.Name=e.Name+"(仓库)"),2===a&&(e.Name=e.Code+"-"+e.Brand+"(货柜)"),3===a&&(e.Name=e.Code+"(托盘)");var r={label:e.Name,Code:e.Code,Name:e.Name,Level:a,WareHouseCode:e.WareHouseCode,ContainerCode:e.ContainerCode,Id:a+"-"+e.Id};return r}}},h=p,m=(a("0b2e"),a("2877")),g=Object(m["a"])(h,r,o,!1,null,"b796fed0",null);t["default"]=g.exports}}]);